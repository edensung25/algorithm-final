<!DOCTYPE html>
<html lang="en">

<head>
	<title>Find the Shortest Path for You</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Travello template project">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="styles/bootstrap4/bootstrap.min.css">
	<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/animate.css">
	<link rel="stylesheet" type="text/css" href="styles/main_styles.css">
	<link rel="stylesheet" type="text/css" href="styles/responsive.css">
	<link rel="stylesheet" type="text/css" href="styles/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="styles/about.css">
	<link rel="stylesheet" type="text/css" href="styles/about_responsive.css">
</head>

<body>

	<div class="super_container">

		<!-- Header -->

		<header class="header">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="header_content d-flex flex-row align-items-center justify-content-start">
							<div class="header_content_inner d-flex flex-row align-items-end justify-content-start">
								<div class="logo"><a href="index.html">Algorithm Group</a></div>
								<nav class="main_nav">
									<ul class="d-flex flex-row align-items-start justify-content-start">
										<li class="active"><a href="index.html">Home</a></li>
										<li><a href="#list">Menu</a></li>
										<li><a href="#map">Map</a></li>
										<li><a href="#about-us">About us</a></li>
									</ul>
								</nav>
								<div class="header_phone ml-auto">Cantact us: lomoteyr@gmail.com</div>

								<!-- Hamburger -->

								<div class="hamburger ml-auto">
									<i class="fa fa-bars" aria-hidden="true"></i>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			
		</header>

		<!-- Menu -->

		<div class="menu">
			<div class="menu_header d-flex flex-row align-items-center justify-content-start">
				<div class="menu_logo"><a href="index.html">Travello</a></div>
				<div class="menu_close_container ml-auto">
					<div class="menu_close">
						<div></div>
						<div></div>
					</div>
				</div>
			</div>
			<div class="menu_content">
				<ul>
					<li><a href="inex.html">Home</a></li>
					<li><a href="about.html">About us</a></li>
					<li><a href="#">Services</a></li>
					<li><a href="news.html">News</a></li>
					<li><a href="contact.html">Contact</a></li>
				</ul>
			</div>
			<div class="menu_social">
				<div class="menu_phone ml-auto">Call us: 00-56 445 678 33</div>
				<ul class="d-flex flex-row align-items-start justify-content-start">
					<li><a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-dribbble" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-behance" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
				</ul>
			</div>
		</div>

		<!-- Home -->

		<div class="home">

			<!-- Home Slider -->
			<div class="home_slider_container">
				<div class="owl-carousel owl-theme home_slider">

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image" style="background-image:url(images/home_slider.jpg)"></div>
						<div class="home_slider_content_container">
							<div class="container">
								<div class="row">
									<div class="col">
										<div class="home_slider_content">
											<div class="home_title">
												<h2>Let's find the best path for you</h2>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image" style="background-image:url(images/home_slider.jpg)"></div>
						<div class="home_slider_content_container">
							<div class="container">
								<div class="row">
									<div class="col">
										<div class="home_slider_content">
											<div class="home_title">
												<h2>Let us take you away</h2>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image" style="background-image:url(images/home_slider.jpg)"></div>
						<div class="home_slider_content_container">
							<div class="container">
								<div class="row">
									<div class="col">
										<div class="home_slider_content">
											<div class="home_title">
												<h2>Let us take you away</h2>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Search -->

		<div class="home_search">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="home_search_container">
							<div class="home_search_title">Search for your trip</div>
							<div class="home_search_content">
								<!-- <form action="#" class="home_search_form" id="home_search_form"> -->
									<div
										class="d-flex flex-lg-row flex-column align-items-start justify-content-lg-between justify-content-start">
										<input type="text" id="DepartureId" class="search_input search_input_2" placeholder="Departure"
											name="start" required="required">
										<input type="text" id="ArrivalId" class="search_input search_input_3" placeholder="Arrival"
											name="end" required="required">
										<a href="#list"><button id="searchbtn" class="home_search_button" onClick="drawMap()">search</button></a>
									</div>
								<!-- </form> -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Intro -->
		<section id="list">
			<div class="intro">
				<div class="container">
					<div class="row">
						<div class="col">
							<div class="intro_container">
								<div class="row" style="height: 150px">
	
									<!-- Intro Item -->
									<div class="col-lg-4 intro_col">
										<div class="intro_item d-flex flex-row align-items-end justify-content-start">
											<div class="intro_icon"><img src="images/wallet.svg" alt=""></div>
											<div class="intro_content">
												<div class="intro_title">The Shortest Pathes</div>
												<div class="intro_subtitle">
													<p>Click the one you prefer.</p>
												</div>
												<input type="checkbox" id="filter" value="maloprodaja" class='chk-btn'>
												<label for='flush'>Show Airports</label>
											</div>
										</div>
									</div>
	
									<!-- Intro Item -->
									<div class="col-lg-8 intro_col" style="margin-top: -55px">
										<div class="intro_item d-flex flex-row align-items-end justify-content-start">
											<div class="intro_content">
												<div id="result-title" class="intro_title"></div>
												<div class="intro_subtitle">
													<button id="option0" class="draw_option_button text-left" onClick="selectRoute(0)"></button>
												</div>
												<div class="intro_subtitle">
													<button id="option1" class="draw_option_button text-left" onClick="selectRoute(1)"></button>
												</div>
												<div class="intro_subtitle">
													<button id="option2" class="draw_option_button text-left" onClick="selectRoute(2)"></button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		

		<section id="map">
			<div id="googleMap" style="width:100%;height:700px;"></div>
		</section>

		<script>
			var flightPath;
			var map;
            var resp;
            var currentIdx = -1;
			function initMap() {
                map = new google.maps.Map(document.getElementById('googleMap'), {
                    zoom: 4.8,
                    center: { lat: 37.8283, lng: -98.5795 },
				});

				var flightPathCoordinates = [];

				flightPath = new google.maps.Polyline({
					path: flightPathCoordinates,
					strokeColor: '#FF0000',
					strokeOpacity: 1.0,
					strokeWeight: 5
				});
				addLine();
			}

			function addLine() {
				flightPath.setMap(map);
			}

			function removeLine() {
				flightPath.setMap(null);
			}

			function selectRoute(idx) {
				this.removeLine();
				var flightPlanCoordinates = [];
				j = parseInt(idx);
				var title = "";
                result = resp;
                    
				for (i = 0 ; i < result['data'][j].length; i++) {
					tmep = {lat: parseFloat(result['data'][j][i]['latitude']), lng: parseFloat(result['data'][j][i]['longitude'])};
                    flightPlanCoordinates.push(tmep);
                    var position = new google.maps.LatLng(tmep.lat, tmep.lon)
	  
					var marker = new google.maps.Marker({
						position: position,
						label: {
							text: "ew",
							color: "#333333",
							fontSize: "13px",
							fontWeight: "bold"
						},
						icon: "images/marker.png",
					});
					marker.setMap(map);
					markers.push(marker);
                }
				var lineSymbol = {
                    path: 'M 0,-1 0,1',
                    strokeOpacity: 1,
                    scale: 4
				};
				flightPath = new google.maps.Polyline({
					path: flightPlanCoordinates,
					strokeOpacity: 0,
					icons: [{
                        icon: lineSymbol,
                        offset: '0',
                        repeat: '20px'
                    }]
				});
                flightPath.setMap(map);
                
                updateMarker(true, idx, result['data'][j]);
                currentIdx = idx;
			}

			function drawMap() {
				this.removeLine();
				var start = document.getElementById("DepartureId");
				var end = document.getElementById("ArrivalId");
				$.ajax({url: "http://127.0.0.1:5000/?start="+start.value+"&destination="+end.value, success: function(result) {
					resp = result
					$("#result-title").html("The result for you:");
					for (j = 0 ; j < result['data'].length; j++) {
						var title = "";
						for (i = 0 ; i < result['data'][j].length; i++) {
							if (title != "") {
								title = title + " -> " + result['data'][j][i]['code'];
							} else {
								title = result['data'][j][i]['code'];
							}
						}
						$("#option"+j).html((j+1)+". "+title);
					}
                    selectRoute(0);
				}
				});
				document.getElementById("DepartureId").value = "";
				document.getElementById("ArrivalId").value = "";
            }
            
            function updateMarker(show, idx, points) {
                for (var i = 0; i < markers.length; i++) {
					markers[i].setMap(null);
				}
                markers = [];
				for (let index = 0; index < points.length; index++) {
					const element = points[index];

					var position = new google.maps.LatLng(element['latitude'], element['longitude'])

					var markerIcon = {
						url: "images/marker.png",
						origin: new google.maps.Point(0, 0),
						anchor: new google.maps.Point(25,50),
						labelOrigin:  new google.maps.Point(25,20),
					};
	  
					var marker = new google.maps.Marker({
						position: position,
						label: {
							text: element['code'],
							color: "#333333",
							fontSize: "13px",
							fontWeight: "bold"
						},
						icon: markerIcon
					});
					marker.setMap(map);
					markers.push(marker);
				}
			}
		
		</script>

		<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCn5fh124bsTgI9vXH5YEO-BqIHr1G1EOI&callback=initMap"></script>

		<section id="about-us">
			<!-- Team -->

			<div class="team">
				<div class="container">
					<div class="row">
						<div class="col text-center">
							<div class="section_title"><h2>About the Team</h2></div>
						</div>
					</div>
					<div class="row team_row">
						
						<!-- Team Item -->
						<div class="col-xl-3 col-md-6 team_col">
							<div class="team_item d-flex flex-column align-items-center justify-content-start text-center">
								<div class="team_image"><img src="images/sahar.jpg" alt=""></div>
								<div class="team_content">
									<div class="team_title"><a href="#">Sahar Omidi</a></div>
									<div class="team_text">
										<p>sahar@pitt.edu</p>
									</div>
								</div>
							</div>
						</div>

						<!-- Team Item -->
						<div class="col-xl-3 col-md-6 team_col">
							<div class="team_item d-flex flex-column align-items-center justify-content-start text-center">
								<div class="team_image"><img src="images/cai-cian.jpg" alt=""></div>
								<div class="team_content">
									<div class="team_title"><a href="#">Cai-Cian Song</a></div>
									<div class="team_text">
										<p>cas386@pitt.edu</p>
									</div>
								</div>
							</div>
						</div>

						<!-- Team Item -->
						<div class="col-xl-3 col-md-6 team_col">
							<div class="team_item d-flex flex-column align-items-center justify-content-start text-center">
								<div class="team_image"><img src="images/james.jpg" alt=""></div>
								<div class="team_content">
									<div class="team_title"><a href="#">Yifei Lin</a></div>
									<div class="team_text">
										<p>yil199@pitt.edu</p>
									</div>
								</div>
							</div>
						</div>

						<!-- Team Item -->
						<div class="col-xl-3 col-md-6 team_col">
							<div class="team_item d-flex flex-column align-items-center justify-content-start text-center">
								<div class="team_image"><img src="images/xuechun.jpg" alt=""></div>
								<div class="team_content">
									<div class="team_title"><a href="#">Xuechun Dong</a></div>
									<div class="team_text">
										<p>xud8@pitt.edu</p>
									</div>
								</div>
							</div>
						</div>

						<!-- Team Item -->
						<div class="col-xl-3 col-md-6 team_col">
								<div class="team_item d-flex flex-column align-items-center justify-content-start text-center">
									<div class="team_image"><img src="images/linlu.jpg" alt=""></div>
									<div class="team_content">
										<div class="team_title"><a href="#">Linlu Liu</a></div>
										<div class="team_text">
											<p>lil131@pitt.edu</p>
										</div>
									</div>
								</div>
							</div>

					</div>
				</div>
			</div>
		</section>
	<!-- Footer -->
	</div>

	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="styles/bootstrap4/popper.js"></script>
	<script src="styles/bootstrap4/bootstrap.min.js"></script>
	<script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
	<script src="plugins/Isotope/isotope.pkgd.min.js"></script>
	<script src="plugins/scrollTo/jquery.scrollTo.min.js"></script>
	<script src="plugins/easing/easing.js"></script>
	<script src="plugins/parallax-js-master/parallax.min.js"></script>
	<script src="js/custom.js"></script>
	<script src="js/AutocompleteFiels.js"></script>
	<script src="js/airports.js"></script>
	<script>
		var markers = [];
		$(function () {

			$("#ArrivalId").autocomplete({
				source: Arrivals
			});

			$("#DepartureId").autocomplete({
				source: Departures
			});
			$.ui.autocomplete.filter = function (array, term) {
				var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex(term), "i");
				return $.grep(array, function (value) {
					return matcher.test(value.label || value.value || value);
				});
			};

			$("#searchbtn").click(function () {
				// alert("shromed");

				var depart = $("#DepartureId").val();
				var Arriv = $("#ArrivalId").val();
				// ShortestPath(depart,Arriv);
				// airportOnMap();
			});

			$('#filter').change(function () {
				if (this.checked) {
					airportOnMap(true);
				}
				else
					airportOnMap(false);
			});

		});
		function ShortestPath(Departure, Arrival) {
			alert(Departure);
			alert(Arrival);
		}

		function airportOnMap(show) {
			if (show) {
				for (let index = 0; index < airports.length; index++) {
					const element = airports[index];

					var position = new google.maps.LatLng(element.lat, element.lon)

					var markerIcon = {
						url: "images/marker.png",
						origin: new google.maps.Point(0, 0),
						anchor: new google.maps.Point(25,50),
						labelOrigin:  new google.maps.Point(25,20),
					};
	  
					var marker = new google.maps.Marker({
						position: position,
						label: {
							text: element.iata,
							color: "#333333",
							fontSize: "13px",
							fontWeight: "bold"
						},
						icon: markerIcon//"images/marker.png",
					});
					marker.setMap(map);
					markers.push(marker);
				}
			}
			else {
				for (var i = 0; i < markers.length; i++) {
					markers[i].setMap(null);
				}
                markers = [];
                if (currentIdx > -1) {
                    updateMarker(true, currentIdx, resp['data'][currentIdx]);
                }
			}
		}
	</script>
	<button onclick="topFunction()" id="back_to_top_button" title="Go to top">Top</button>
</body>
<script>
	$(document).ready(function(){
	  $("a").on('click', function(event) {
		if (this.hash !== "") {
		  event.preventDefault();
		  var hash = this.hash;
		  $('html, body').animate({
			scrollTop: $(hash).offset().top
		  }, 800, function(){
			window.location.hash = hash;
		  });
		}
	  });
	});

	window.onscroll = function() {scrollFunction()};

	function scrollFunction() {
		if (document.body.scrollTop > 700 || document.documentElement.scrollTop > 700) {
			document.getElementById("back_to_top_button").style.display = "block";
		} else {
			document.getElementById("back_to_top_button").style.display = "none";
		}
	}

	function topFunction() {
		$("html, body").animate({ scrollTop: "0px" });
	}
	</script>
</html>